!function(a){var b=a.module("DeferredWithUpdate",[]);b.service("DeferredWithUpdate",["$q",function(a){this.all=function(){return a.all.apply(a,arguments)},this.defer=function(){var b=a.defer(),c=b.promise,d={resolve:b.resolve,reject:b.reject,then:c.then},e=!1,f=!1,g=[],h=[];return b.resolve=function(){if(e&&!f)for(var a=0,c=g.length;a<c;a++)g[a].apply({},arguments);else e=!0,d.resolve.apply(b,arguments)},b.reject=function(){if(e)for(var a=0,c=h.length;a<c;a++)h[a].apply({},arguments);else f=!0,d.reject.apply(b,arguments)},c.then=function(){var a=d.then.apply(c,arguments);return a.update=c.update,a.mistake=c.mistake,a},c.update=function(a){return g.push(a),c},c.mistake=function(a){return h.push(a),c},b},this.reject=function(){return a.reject.apply(a,arguments)},this.when=function(){return a.when.apply(a,arguments)}}])}(angular);